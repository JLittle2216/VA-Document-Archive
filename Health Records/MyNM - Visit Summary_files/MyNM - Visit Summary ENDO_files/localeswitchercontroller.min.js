!function WP$UI$LocaleSwitcherController$definition(){var e=function WP$UI$LocaleSwitcherController(e){this.WP$Controllers$Controller(),this.proxify("_localeButtonKeyDown","_localeButtonClick","_openLocaleDropdown","_closeLocaleDropdown","_setFocusToMenuButton"),this.proxify("_setFocusToFirstLink","_setFocusToLastLink","_setFocusToNextLink","_setFocusToPreviousLink","_localeLinkKeyDown"),this.proxify("_localeLinkClick"),this.$root=e,this.$menuButton=this.$root.find("button#localeswitch"),this.$links=this.$root.find(".morelocalesitemlink"),this.$currentLocaleLink=this.$root.find("#currentlanguagelink"),this.$firstLink=this.$links.first(),this.$lastLink=this.$links.last(),this.$localesList=this.$root.find("#morelocalesnav"),this.numLinks=this.$links.length,this.currentIndex=0,this.keyCode={TAB:9,RETURN:13,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40},this.$root.on("blur",this._closeLocaleDropdown),this.$menuButton.on("keydown",this._localeButtonKeyDown),this.$menuButton.on("click",this._localeButtonClick),this.$links.on("keydown",this._localeLinkKeyDown),this.$currentLocaleLink.on("click",this._closeLocaleDropdown),this.$links.on("click",this._localeLinkClick)};e.prototype={$root:null,$menuButton:null,$links:null,$firstLink:null,$lastLink:null,$localesList:null,currentIndex:0,_localeButtonKeyDown:function WP$UI$LocaleSwitcherController$_localeButtonKeyDown(e){var o=!0;switch(e.keyCode){case this.keyCode.SPACE:case this.keyCode.RETURN:this._openLocaleDropdown(),this._setFocusToFirstLink();break;default:o=!1}o&&(e.stopPropagation(),e.preventDefault())},_localeButtonClick:function WP$UI$LocaleSwitcherController$_localeButtonClick(e){"true"===this.$menuButton.safeAttr("aria-expanded")?this._closeLocaleDropdown(!0):(this._openLocaleDropdown(),this._setFocusToFirstLink()),e.stopPropagation(),e.preventDefault()},_localeLinkClick:function WP$UI$LocaleSwitcherController$_localeLinkClick(e){var o=$afe.jq(e.currentTarget);if("currentlanguagelink"!==o.safeAttr("id")){var t="";if(WP.DOM.Browser.isIE){var s;if(-1!==(t=document.location.href).indexOf("?")&&(s=t.substring(t.indexOf("?")+1).split("&")),t=document.location.pathname,s&&s.length>0)for(var i=0;i<s.length;i++)s[i]=s[i].split("="),s[i][0]&&"lang"!==s[i][0].toLowerCase()&&(void 0===s[i][1]&&(s[i][1]=""),t=addQueryStringToUrl(t,s[i][0],s[i][1]));t=addQueryStringToUrl(t,"lang",o.safeAttr("lang"))}else{var n=new URLSearchParams(document.location.search);n.set("lang",o.safeAttr("lang")),t=document.location.pathname+"?"+n.toString()}return $$WP.Utilities.TryRedirect(t),!1}return!0},_openLocaleDropdown:function WP$UI$LocaleSwitcherController$_openProxyDropdown(){this.$localesList.removeClass("localeHide").removeClass("jqHidden").addClass("localeShow").safeAttr("aria-hidden","false"),this.$menuButton.safeAttr("aria-expanded","true"),$afe.select("body").on("click",this._closeLocaleDropdown)},_closeLocaleDropdown:function WP$UI$LocaleSwitcherController$_closeLocaleDropdown(e){this.$menuButton.safeAttr("aria-expanded","false"),this.$localesList.removeClass("localeShow").addClass("localeHide").addClass("jqHidden").safeAttr("aria-hidden","true"),e||this._setFocusToMenuButton(),$afe.select("body").off("click",this._closeLocaleDropdown)},_setFocusToMenuButton:function WP$UI$LocaleSwitcherController$_setFocusToMenuButton(){this.$menuButton.focus()},_setFocusToFirstLink:function WP$UI$LocaleSwitcherController$_setFocusToFirstLink(){this.$firstLink.focus(),this.currentIndex=0},_setFocusToLastLink:function WP$UI$LocaleSwitcherController$_setFocusToLastLink(){this.$lastLink.focus(),this.currentIndex=this.numLinks-1},_setFocusToPreviousLink:function WP$UI$LocaleSwitcherController$_setFocusToPreviousLink(e){return this.currentIndex<=0?e?(this._setFocusToLastLink(),!1):(this._closeLocaleDropdown(),!0):(this.$links.eq(--this.currentIndex).focus(),!1)},_setFocusToNextLink:function WP$UI$LocaleSwitcherController$_setFocusToNextLink(e){return this.currentIndex>=this.$links.length-1?e?(this._setFocusToFirstLink(),!1):(this._closeLocaleDropdown(),!0):(this.$links.eq(++this.currentIndex).focus(),!1)},_localeLinkKeyDown:function(e){var o=!1;if(!(e.ctrlKey||e.altKey||e.metaKey)){if(e.shiftKey)e.keyCode===this.keyCode.TAB&&(o=!this._setFocusToPreviousLink(!1));else switch(o=!0,e.keyCode){case this.keyCode.ESC:this._closeLocaleDropdown();break;case this.keyCode.SPACE:this._localeLinkClick(e);break;case this.keyCode.UP:this._setFocusToPreviousLink(!0);break;case this.keyCode.DOWN:this._setFocusToNextLink(!0);break;case this.keyCode.TAB:o=!this._setFocusToNextLink(!1);break;case this.keyCode.HOME:case this.keyCode.PAGEUP:this._setFocusToFirstLink();break;case this.keyCode.END:case this.keyCode.PAGEDOWN:this._setFocusToLastLink();break;default:o=!1}o&&(e.stopPropagation(),e.preventDefault())}}},$$WP.UI=$$WP.UI||{},$$WP.UI.LocaleSwitcherController=e,e.extend($$WP.Controllers.Controller,"WP$UI$LocaleSwitcherController")}();