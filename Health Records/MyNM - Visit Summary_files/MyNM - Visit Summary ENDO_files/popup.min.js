$$WPUtil.guaranteeExistence($$WP,"Popups"),$$WPUtil.guaranteeExistence($$WP,"Utilities.UI");var $$WPPop=$$WP.Popups;$$WPContain.Popup=function WPContain$Popup(t){switch($$WPComp.applySettings(t,this),this.Size){case $$WPContain.Popup.SizeEnum.SMALL:this.Class+=" small";break;case $$WPContain.Popup.SizeEnum.MEDIUM:this.Class+=" medium";break;case $$WPContain.Popup.SizeEnum.LARGE:this.Class+=" large"}null===this.positioningFunction&&(this.positioningFunction=$$WPContain.Positions.InsideCentered),this.$parent=$afe.select("#classicPopupRoot"),this.$parent=this.$parent&&this.$parent.length>0?this.$parent:$afe.jq(document.body),this._shouldOverrideMobileBack()&&(Array.isArray(this.Components)?this.Components.forEach((function(t){t.IsClosable=!1})):this.Components.IsClosable=!1),this.Containers$ContainerComponent({}),this.addEventListener("resize",this._resizePopup),this.addEventListener("click",this._clickPopup),this.addEventListener("keydown",this._keydownPopup),this.addEventListener("fullscreenchange",this._adjustFullscreen),this.GetInvisibleLastFocusAnchor&&this.addEventListener("keyup",this._keyupPopup),$$WP.Utilities.UI.IsMobile&&this.addEventListener("focusout",this._onMobileFocusOut),!1!==this.HasBackButton&&(this.HasBackButton||isDataTile()&&this.IsClosable&&this.Size!=$$WPContain.Popup.SizeEnum.SMALL)&&(""===this.BackButtonText&&(this.BackButtonText=$$WP.Strings.get("PopupBackToPreviousPageButton",this.StringsNamespace)),null===this.ToolbarButtons&&(this.ToolbarButtons=[]),this.ToolbarButtons.push(new $$WPComp.ComplexObjects.Button(this.BackButtonText,null,"secondary neutral previouspage","close",this.BackButtonText)))},$$WPContain.Popup.SizeEnum={SMALL:1,MEDIUM:2,LARGE:3,AUTO:4},$$WPContain.Popup.__zIndex=0,$$WPContain.Popup.prototype={ToolbarButtons:null,HasOverlay:!0,IsClosable:!0,Class:"Popup",positioningFunction:$$WPContain.Positions.InsideCentered,Size:$$WPContain.Popup.SizeEnum.SMALL,_IsWindowScrollDisabled:!1,_ScrollBarPosition:0,_ScrollBarLeft:0,_IsScrollBarDisabledWhenOpened:!1,_InitialBodyMarginTop:0,_InitialBodyMarginLeft:0,$parent:$afe.select("body"),HasBackButton:null,BackButtonText:"",GetLastFocus:null,MonitorAriaLiveContent:!0,OnCloseCallback:null,_MinContentHeight:null,AriaLabelledByID:"",AriaDescribedByID:"",PierceShieldOfJustice:!1,CanResetFocusOnKeydown:!1,GetInvisibleLastFocusAnchor:null,_componentsHaveTitleText:function(){if(this.TitleText&&this.TitleText.string&&!$$WP.Utilities.IsNullOrEmpty(this.TitleText.string))return!0;if(this._Title&&this._Title.Text&&!$$WP.Utilities.IsNullOrEmpty(this._Title.Text))return!0;for(i=0;i<this._Components.length;i++){if(this._Components[i].TitleText&&this._Components[i].TitleText.string&&!$$WP.Utilities.IsNullOrEmpty(this._Components[i].TitleText.string))return!0;if(this._Components[i]._Title&&this._Components[i]._Title.Text&&!$$WP.Utilities.IsNullOrEmpty(this._Components[i]._Title.Text))return!0}return!1},show:function WPContain$Popup$show(t){if(this._componentsHaveTitleText()||$$WP.Debug.logError("TitleText cannot be null or empty for popups."),!0!==this._visible){this.__setAriaHidden(!0),this.$container.find(".alertLive").length>0&&(this.MonitorAriaLiveContent=!1),this.$container.safeAttr("role","dialog"),this.$container.safeAttr("aria-modal","true"),this._ScrollBarPosition=$$WPUtil.getScrollTop(),this._ScrollBarLeft=$$WPUtil.getScrollLeft(),this._IsScrollBarDisabledWhenOpened=$afe.select("body").hasClass("scrollDisabled"),this._IsScrollBarDisabledWhenOpened&&(this._InitialBodyMarginTop=$afe.select("body").css("margin-top"),this._InitialBodyMarginLeft=$afe.select("body").css("margin-left")),this.setAppropriateScrollBar(),$$WP.Debug.UpdateTopMarginForBanners(),this.HasOverlay&&this._overlay.on(!this.IsClosable,this),this.Containers$ContainerComponent$show(t);var e,i=$afe.select("#popupCloseAction");if(i&&i.on("click","",this.ComponentNumber,this._closePopup),this._supportsAriaDescription()&&(this.AriaDescribedByID.length>0||(e=this.AriaDescriptionComponentNumber>-1?this.AriaDescriptionComponentNumber:this.ComponentNumber,this.AriaDescribedByID="popupdescription"+e),this.$container.safeAttr("aria-describedby",this.AriaDescribedByID),this.MonitorAriaLiveContent=!1),this._supportsAriaLabel()&&(this.AriaLabelledByID.length>0||(e=this.AriaLabelComponentNumber>-1?this.AriaLabelComponentNumber:this.ComponentNumber,this.AriaLabelledByID="popuplabel"+e),this.$container.safeAttr("aria-labelledby",this.AriaLabelledByID)),this.MonitorAriaLiveContent&&(this.$container.safeAttr("aria-live","polite"),this.$container.safeAttr("aria-relevant","additions")),this.setFocus(),this.focus(),$afe.jq(window).on("resize orientationchange","",this.ComponentNumber,this.__windowResize),this._shouldOverrideMobileBack()){var o=this._getMobileBackEvents();this.$container.data("_cachedWindowEvents",[]),o.forEach((function(t){this.$container.data("_cachedWindowEvents").push(t)}),this),$afe.jq(window).off("mobile_back"),$afe.jq(window).on("mobile_back","",this.ComponentNumber,this.__mobileBack)}if(this.__otherPopupsExist()&&(this.__setAriaHiddenPreviousPopupContent(!0),popupAlert=this._createPopupAlert(),this.$container.safePrepend(popupAlert),this.focus(),popupAlert.setAttribute("tabindex","-1")),this._MinContentHeight=$$WPUtil.cssValueToPixels(this.$content.css("min-height")),this.setAppropriateContentHeight(),isDataTile()&&this.Size!==$$WPContain.Popup.SizeEnum.SMALL)try{window.history.pushState(null,null,location.href),scrollTopOfTheIframe(0,!0)}catch(t){$$WP.Debug.log("Cannot add Push state as the parent domain is not accessible")}}},setAppropriateScrollBar:function WPContain$Popup$setAppropriateScrollBar(){var t,e,i,o=$afe.select("body"),s=$afe.jq(window),n=$afe.select("#header");if(t=s.width(),e=s.height(),$$WPUtil.cssValueToPixels(o.css("min-width")),i=this.$container.outerHeight()+this.$container.offset().top<=e&&this.$container.outerWidth()<=t,!isDataTile()&&i){var a=$$WPUtil.getScrollTop(),r=$$WPUtil.getScrollLeft(),l=n.hasClass("compact");this._IsWindowScrollDisabled=!0,a>75&&(l||n.hasClass("static")||(n.addClass("compact"),s.trigger("compactHeader"),l=!0)),this._IsScrollBarDisabledWhenOpened||(o.css({"margin-top":"-"+a+"px"}),o.css({"margin-left":"-"+r+"px"}),o.addClass("scrollDisabled"),$$WP.Utilities.UI.EnforceEpicLogoVisibility(!l))}else this._IsWindowScrollDisabled=!1,o.css({"margin-top":""}),o.css({"margin-left":""}),o.removeClass("scrollDisabled")},setAppropriateContentHeight:function WPContain$Popup$setAppropriateContentHeight(){var t,e,i,o,s,n,a=$afe.select("#header").outerHeight();this._IsWindowScrollDisabled?(e=$afe.jq(window).innerHeight(),i=$afe.select(".Popup > .scrollable > .titlebar").outerHeight(),t=e-2*a-(n=$afe.select(".Popup > .scrollable > .toolbar").outerHeight())-i,this.$content.contentHeight(),s=e-a-n-i-10,void 0!==(o=this._MinContentHeight)&&o>s&&(o=s),void 0!==o&&o>t&&(t=o),t<150&&(t=150),this.$container.find("> .scrollable > .content").css({"max-height":t+"px","overflow-y":"auto","min-height":o+"px"})):this.$container.find("> .scrollable > .content").css({"max-height":"","overflow-y":"visible"})},setFocus:function(){try{this.firstFocus=WP.DOM.Search.getNextFocusable(this.$container.get(0))}catch(t){}try{null!==this.GetLastFocus?this.lastFocus=this.GetLastFocus(this.$container.get(0)):this.lastFocus=WP.DOM.Search.getLastFocusable(this.$container.get(0))}catch(t){}this.isFirstFocus=!1},__focus:function(){try{var t;(t=Array.isArray(this._Components)?this.__findFirstFocusableContent(this._Components,0):WP.DOM.Search.getNextFocusable(this._Components.$content))||"skipToMain"===(t=WP.DOM.Search.getNextFocusable(this.$container.get(0))).id&&(t=WP.DOM.Search.getNextFocusable(t)),this.PierceShieldOfJustice&&t.setAttribute("data-pierce-shield","true"),t.focus()}catch(t){}},__windowResize:function(t){var e=$$WPComp.getInstance(t.data);e&&(e._IsWindowScrollDisabled=!1,e.setAppropriateScrollBar(),e.$container.trigger("resize"))},hide:function WPContain$Popup$hide(t){if(!1!==this._visible){this.__otherPopupsExist()?this.__setAriaHiddenPreviousPopupContent(!1):this.__setAriaHidden(!1),this.Containers$ContainerComponent$hide(t),this._visible=!1,this._IsScrollBarDisabledWhenOpened?$afe.select("body").css({"margin-top":this._InitialBodyMarginTop,"margin-left":this._InitialBodyMarginLeft}):$afe.select("body").css({"margin-top":"","margin-left":""}).removeClass("scrollDisabled"),this._IsWindowScrollDisabled=!1,this.HasOverlay&&this._overlay.off(!this.IsClosable,this);try{var e=isDataTile()&&null!=window.frameElement;this.FocusOnClose.focus({preventScroll:e})}catch(t){}if(this._ScrollBarPosition&&$$WPUtil.setScrollTop(this._ScrollBarPosition),this._ScrollBarLeft&&$$WPUtil.setScrollLeft(this._ScrollBarLeft),1===$afe.select(".Popup.component").length&&$afe.jq(window).off("resize orientationchange","",this.__windowResize),this._shouldOverrideMobileBack()){var i=this.$container.data("_cachedWindowEvents");i&&($afe.jq(window).off("mobile_back"),i.forEach((function(t){$afe.jq(window).on("mobile_back",t.selector,t.data,t.handler)})))}"function"==typeof this.OnCloseCallback&&this.OnCloseCallback()}},reposition:function WPContain$Popup$reposition(t){if(0!==this.$container.parent().length){var e=this.$container.css("opacity");this.$container.css("opacity",0);try{this.positioningFunction({data:this},t)}catch(t){throw"repositioning error"}this.$container.css("opacity",e)}},setTitle:function(t,e,i,o){var s;t||e&&0!==e.length||o?this.$container.removeClass("notitle"):(s=!0,e=[new $$WPComp.ComplexObjects.Button($$WP.Strings.getForTemplate("JumpToContent","Core.Popup"),null,"clearlabel","jumptocontent")],this.$container.addClass("notitle")),this.Containers$ContainerComponent$setTitle(t,e,i,o),s&&this.$title.addClass("clearlabel")},_resizePopup:function WPContain$Popup$_resize(){return!!this.isVisible()&&(this.reposition(!0),this.setAppropriateContentHeight(),this.setFocus(),!1)},_clickPopup:function(t){return t.dataId===$$WPComp.TITLEBARIDENTIFIER+"jumptocontent"?(this.focus(!0),!1):"focusanchor"!==t.dataId&&void 0},_adjustFullscreen:function(){$afe.select("body").css("margin-left","-"+this._ScrollBarLeft+"px"),this.reposition(!0)},_onMobileFocusOut:function(t){t.relatedTarget||$afe.jq(window).scrollTop(0)},_keydownPopup:function WPContain$Popup$_keydown(t){this.canResetFocusOnKeydown&&this.setFocus();var e=$afe.select(".infoBubbleWrapper.hover").length>0;if(27===t.keyCode&&this.IsClosable&&!e&&this.dispose(!1),9===t.keyCode){if(t.target===this.firstFocus||t.target===this.lastFocus)return t.shiftKey&&t.target===this.firstFocus?(this.lastFocus&&this.lastFocus.focus(),this.isFirstFocus&&delete this.isFirstFocus,!1):t.shiftKey||t.target!==this.lastFocus?void 0:(this.firstFocus&&this.firstFocus.focus(),this.isFirstFocus&&delete this.isFirstFocus,!1);if(this.isFirstFocus){var i=t.shiftKey?this.lastFocus:this.firstFocus;return i&&i.focus(),delete this.isFirstFocus,!1}}},_keyupPopup:function WPContain$Popup$_keyup(t){var e=this.GetInvisibleLastFocusAnchor(this.$container.get(0));if(e)return t.shiftKey||t.target!==e?void(t.shiftKey&&t.target===e&&WP.DOM.Search.getPreviousFocusable(e).focus()):(e===this.lastFocus?(this.firstFocus&&this.firstFocus.focus(),this.isFirstFocus&&delete this.isFirstFocus):WP.DOM.Search.getNextFocusable(e).focus(),!1)},__mobileBack:function(t){var e=$$WPComp.getInstance(t.data);e&&e.dispose()},_shouldOverrideMobileBack:function WPContain$Popup$_shouldOverrideMobileBack(){if(!$$WP.Utilities.UI.IsMobile||this.Size!==$$WPContain.Popup.SizeEnum.MEDIUM&&this.Size!==$$WPContain.Popup.SizeEnum.LARGE||isDataTile())return!1;var t=this._getMobileBackEvents();return t&&t.length>0},_getMobileBackEvents:function WPContain$Popup$_getMobileBackEvents(){var t=$._data(window,"events");return t?t.mobile_back:null},_overlay:{on:function WPContain$Popup$overlay$on(t,e){var i,o;o=(o=(o=$afe.select("#classicPopupRoot"))&&o.length>0?o:$afe.select("body"))&&o.length>0?o:$afe.select("#datatile"),$$WPContain.Popup.__zIndex+=3,i=3e3+$$WPContain.Popup.__zIndex,e.$overlay=$afe.renderTemplate($$WP.Templates.Core.overlay,{}),o.safeAppend(e.$overlay),e.$overlay.show(),e.$overlay.css("z-index",i),e.$container.css("z-index",i+1),$$WP.Utilities.UI.PDF&&$$WP.Utilities.UI.PDF.needIframeShim()&&$$WP.Utilities.UI.PDF.pageHasEmbeddedPdf()&&$$WP.Utilities.UI.PDF.hidePdfs(),t||e.$overlay.on("click","",e.ComponentNumber,e._overlay._overlayClick)},off:function WPContain$Popup$overlay$off(t,e){var i;t||e.$overlay.off("click","",e._overlay._overlayClick),e.$overlay.remove(),i=$afe.select(".lb_overlay:visible").length,$$WP.Utilities.UI.PDF&&$$WP.Utilities.UI.PDF.needIframeShim()&&$$WP.Utilities.UI.PDF.pageHasEmbeddedPdf()&&0==i&&$$WP.Utilities.UI.PDF.showPdfs()},_overlayClick:function WPContain$Popup$overlay$overlayClick(t){var e=$$WPComp.getInstance(t.data);return e&&e.dispose(),$$WPUtil.preventEvent(t)}},__setAriaHidden:function(t){var e=this.__getPageElementsForAria();for(i=0;i<e.length;i++)e[i].setAttribute("aria-hidden",t)},__getPageElementsForAria:function(){return document.querySelectorAll("[data-hide-during-popup='true']")},__setAriaHiddenPreviousPopupContent:function(t){var e=[];for(e=this.__getAllPopups(),i=0;i<e.length;i++)e[i].getAttribute("data-component-id")!==this.$container.safeAttr("data-component-id")&&e[i].setAttribute("aria-hidden",t)},__otherPopupsExist:function(){return this.__getAllPopups().length>1},__getAllPopups:function(){var t=[],e=[],o=0;for(t=document.querySelectorAll("div[data-component-id]"),i=0;i<t.length;i++)t[i].classList.contains("Popup")&&(e[o++]=t[i]);return e},__findFirstFocusableContent:function(t,e){if(e>=t.length)return null;var i=t[e].$content;if(!i)return this.__findFirstFocusableContent(t,++e);var o=WP.DOM.Search.getNextFocusable(i.get(0));return null!==o&&"popupCloseAction"!==o.id&&"OBJECT"!==o.tagName.toUpperCase()&&this.$container.get(0).contains(o)?o:this.__findFirstFocusableContent(t,++e)},focus:function WPPopup$focus(){try{null===this.FocusOnClose&&(this.FocusOnClose=WP.DOM.Search.getFocused(document.body))}catch(t){}try{this.__focus()}catch(t){}},_supportsAriaDescription:function(){if(this.SupportsAriaDescription)return!0;for(i=0;i<this._Components.length;i++)if(this._Components[i].SupportsAriaDescription)return this.AriaDescriptionComponentNumber=this._Components[i].ComponentNumber,!0;return!1},_supportsAriaLabel:function(){if(this.SupportsAriaLabel)return!0;for(i=0;i<this._Components.length;i++)if(this._Components[i].SupportsAriaLabel)return!0;return!1},_closePopup:function(t){var e=$$WPComp.getInstance(t.data);e&&e.dispose()},_createPopupAlert:function(){var t=document.createElement("span");t.className="clearlabel",t.setAttribute("tabindex","0"),t.setAttribute("role","alert"),this.hasOwnProperty("PierceShieldOfJustice")&&t.setAttribute("data-pierce-shield","true");var e=this._Title.Text.toString(),i=$$WP.Strings.getNamespace("Core.Popup"),o=isDataTile()&&this.Size!==$$WPContain.Popup.SizeEnum.SMALL?"PopupWindowAlert":"PopupAlert";o+=e?"WithTitle":"",i.addMnemonic("@MYCHART@PopupTitle@",e);var s=i.getStringForTemplate(o);return i.removeMnemonic("@MYCHART@PopupTitle@"),t.appendChild(document.createTextNode(s)),t}},$$WPContain.Popup.extend("Containers.ContainerComponent"),$afe.jq(window).on("popupResize",(function(){var t=$$WPComp.getInstance($afe.select(".Popup.component").safeAttr("data-component-id"));null!==t&&$$WPComp.isComponent(t)&&"function"==typeof t.setAppropriateContentHeight&&t.setAppropriateContentHeight()}));