/*! Copyright (c) Epic Systems Corporation 2014 - 2016 */
$$WPUtil.guaranteeExistence($$WP,"Components"),$$WP.Components.Calendar=function $$WPCal(e){var t,a,n,s;"undefined"!=typeof $$WP&&void 0!==$$WP.Strings&&($$WP.Strings.setDefaultNamespace("Global.Calendar"),$$WP.Strings.add("CalendarMonthTitleFormat","Jan"),$$WP.Strings.add("CalendarAudibleDate","_STR_AudibleDate_"),$$WP.Strings.add("HoverText",$$WP.Strings.get("SelectTooltip","UI.Calendar")),$$WP.Strings.add("HoverTextDisabled",$$WP.Strings.get("NotAvailableTooltip","UI.Calendar")),$$WP.Strings.add("NextButton",""),$$WP.Strings.add("PrevButton",""),$$WP.Strings.clearDefaultNamespace()),this.onSelect=e.onSelect||function(e){},this.TitleText=e.TitleText||"",this.Image=e.Image||"",this.filter=e.filter||function(){return!0},this.FromDTE=e.FromDTE,this.ToDTE=e.ToDTE,this.callback=e.callback||function(){},this.SelectedDate=e.SelectedDate,this.HighlightDays=e.HighlightDays||[],this.HasSelectableDays=!0===e.HasSelectableDays,this._calendarMouseover=e._calendarMouseover||this._calendarMouseover,this.IsClickEventEnabled=e.IsClickEventEnabled||!0,this.IsNextEnabled=e.IsNextEnabled||!1,this.IsPrevEnabled=e.IsPrevEnabled||!1,this.IsAriaHidden=e.IsAriaHidden||!1;for(var i=0;i<this.HighlightDays.length;i++)this.HighlightDays[i].length>0&&(a=(t=new Date(this.HighlightDays[i])).getMonth()+1,s=t.getDate(),n=t.getFullYear(),this.Dict[a+"/"+s+"/"+n]=!0,this.SelectableMonths[a+"/"+n]=!0);$$WP.Utilities.IsNullOrEmpty(this.SelectedDate)?this.Today=new Date:"function"==typeof this.SelectedDate.getYear?this.Today=this.SelectedDate:"string"==typeof this.SelectedDate.getYear?this.Today=new Date(this.SelectedDate):this.Today=new Date,this.Month=this.Today.getMonth(),this.Year=this.Today.getFullYear(),this.PrevButton=$$WP.Strings.get("PrevButton","Global.Calendar"),this.NextButton=$$WP.Strings.get("NextButton","Global.Calendar"),this.HoverText=$$WP.Strings.get("HoverText","Global.Calendar"),this.HoverTextDisabled=$$WP.Strings.get("HoverTextDisabled","Global.Calendar");for(var r=0;r<7;r++)this.Days[r]='<span class="clearlabel">'+getDayName((r+getFirstDayOfWeek())%7)+"</span>"+getDayLetter((r+getFirstDayOfWeek())%7);this.Components$TemplateComponent(e),this.addEventListener("click",this._calendarClick),this.addEventListener("focus",this._calendarFocus)},$$WP.Components.Calendar.prototype={Today:{},Title:"",Image:"",Summary:"",Class:"calendar",filter:"",FromDTE:"",ToDTE:"",Callback:"",SelectedDate:"",HoverText:"",HoverTextDisabled:"",Month:"",Year:"",Days:[],PrevButton:"",NextButton:"",HighlightDays:[],HasSelectableDays:"",Dict:{},SelectableMonths:{},data:{},IsClickEventEnabled:!0,IsNextEnabled:!1,IsPrevEnabled:!1,IsAriaHidden:!1,template:$$WP.Templates.Core.calendar,setData:function $$WP$Components$Calendar$set(){this.setTitles(),this.Components$TemplateComponent$setData(this.Data)},setTitles:function $$WP$Components$Calendar$title(){var e,t,a,n,s,i,r=this.Month,l=this.Year;this.hasSelectableDay(r,l),n=$$WP.I18N.monthTitleFormat(makeDate(l,r+1)),$$WP.Strings.setDefaultNamespace("UI.Calendar"),$$WP.Strings.addMnemonic("@MYCHART@DATEWITHMONTH@",$$WP.I18N.monthTitleFormat(makeDate(l,r))),e=$$WP.Strings.get("CalendarNextPrevMonthHelpText"),$$WP.Strings.removeMnemonic("@MYCHART@DATEWITHMONTH@"),$$WP.Strings.addMnemonic("@MYCHART@DATEWITHMONTH@",$$WP.I18N.monthTitleFormat(makeDate(l,r+2))),s=$$WP.Strings.get("CalendarNextPrevMonthHelpText"),$$WP.Strings.removeMnemonic("@MYCHART@DATEWITHMONTH@"),$$WP.Strings.clearDefaultNamespace(),t=this.IsPrevEnabled,i=this.IsNextEnabled,a=this.IsAriaHidden,this.Data={PrevClass:undefined,PrevButton:this.PrevButton,IsPrevEnabled:t,Title:n,PrevTitle:e,NextTitle:s,NextClass:undefined,NextButton:this.NextButton,IsNextEnabled:i,IsAriaHidden:a,Days:this.Days,ComponentNumber:this.ComponentNumber}},reInit:function $$WP$Components$Calendar$refresh(e){var t,a,n,s,i;if(e.HighlightDays)for(var r=0;r<e.HighlightDays.length;r++)(i=e.HighlightDays[r])&&i.length>0&&(a=(t=new Date(i)).getMonth()+1,s=t.getDate(),n=t.getFullYear(),this.Dict[a+"/"+s+"/"+n]=!0);this.setData(),this.refresh()},html:function(e){this.Components$Component$html(e),this.$content.find(".hasevents").safeAttr("data-id","hasevents")},_calendarClick:function $$WP$Components$Calendar$_click(e,t,a){this.IsClickEventEnabled&&("calnext"===e.dataId&&(this.drawNextMonth(),WP.Events.cancelEvent(e),WP.Events.preventDefault(e)),"calprev"===e.dataId&&(this.drawPreviousMonth(),WP.Events.cancelEvent(e),WP.Events.preventDefault(e)))},_calendarFocus:function $$WP$Components$Calendar$_focus(e,t){this.$$WP$Components$Calendar$_mouseover(e,t)},_isInCalendar:function $$WP$Components$Calendar$_isInCalendar(e){var t,a;for(a=e,t=0;a&&t<6;a=a.parentNode,t++)if(a&&a.id&&"calendar"===a.id.toLowerCase())return!0;return!1},setClickFunction:function $$WP$Components$Calendar$setClickFunction(e){var t,a,n,s=this.hoverText,i=this.hoverTextDisabled,r=this.clickFunction,l=e.getElementsByTagName("td"),o=new Date,d=document.all?"hand":"pointer",enable=function(e,t){WP.Events.addListener(e,"click",r),"ctrl"===e.className?(WP.Events.addListener(e,"mouseover",hi()),WP.Events.addListener(e,"mouseout",lo),WP.Events.addListener(e.firstChild,"focus",hi(!0)),WP.Events.addListener(e.firstChild,"blur",lo)):(WP.Events.addListener(e,"mouseover",(function(){e.firstChild.focus()})),WP.Events.addListener(e.firstChild,"focus",hi())),e.style.cursor=d,!0!==t&&(e.title=s)},disable=function(e){e.style.cursor="default",e.title=i};for(a=0;a<l.length;++a)"null"!==(n=(t=l[a]).className)&&"hdr"!==n&&t.firstChild&&("ctrl"===n?enable(t,!0):n.indexOf("othermonth")>0||0===n.indexOf("n")||0===n.indexOf("wkndn")||"ctrln"===n?disable(t):"today"!==n||this.filter(o.getFullYear(),o.getMonth(),o.getDate())?enable(t):disable(t))},drawNextMonth:function $$WP$Components$Calendar$drawNextMonth(){this.Month=(this.Month+1)%12,0===this.Month&&this.Year++,this.set()},drawPreviousMonth:function $$WP$Components$Calendar$drawPreviousMonth(){this.Month=this.Month-1,this.Month<0&&(this.Month+=12),11===this.Month&&this.Year--,this.getCalendarObject(),this.set()},hasSelectableDay:function $$WP$Components$Calendar$hasSelectableDay(e,t){var a=1,n=makeDate(t,e+1,a);for(e=n.getMonth();n.getMonth()===e;){if(this.filter(n.getFullYear(),n.getMonth(),a))return!0;n.setDate(++a)}return!1},getCalendarObject:function $$WP$Components$Calendar$getCalendarObject(e){var t,a,n,s,i,r=document.createElement("tbody"),l=this.Month,o=this.Year,d=new Date,h=d.getDate(),$=d.getMonth(),c=d.getFullYear(),g=WP.DOM.Create.tag,u=(this.hasSelectableDay(l,o),this.IsAriaHidden),D=this;d.setHours(0,0,0,0);var C,m,hasEvent=function(e,t,a,n){var s=e.getMonth(),i=e.getDate(),r=e.getFullYear();e.getDay();return!($$WP.Utilities.IsNullOrEmpty(a)||t||!a[s+1+"/"+i+"/"+r])},getClassName=function(e,t,a,n){var s,i=e.getMonth(),r=e.getDate(),o=e.getFullYear(),d="",g=e.getDay();if($$WP.Utilities.IsNullOrEmpty(a)||t||a[i+1+"/"+r+"/"+o]&&(d=" hasevents"),e<n)d+=" past";else if(i===l&&i===$&&r===h&&o===c)return"today"+d;return d+=t?" othermonth":"",s=0===g||6===g,D.filter(o,i,r)&&!t?(s?"wknd":"d")+d:(s?"wkndn":"n")+d};for((C=(a=makeDate(o,l+1,1)).getDay()-getFirstDayOfWeek())<0&&(C+=7),a.setDate(a.getDate()-C);a.getMonth()!==l+1&&a.getFullYear()<=o;){for(t=document.createElement("tr"),m=0;m<7;m++){i=a.getMonth()!==l;var P=hasEvent(a,i,this.Dict);!i&&this.filter(o,l,a.getDate())?(P?(s=WP.DOM.Create.anchoredNode(this.drawCalendarDate(a),!0,"")).className="haseventfocus selectableevent":s=this.drawCalendarDate(a),this.firstDate&&""!==this.firstDate||(this.firstDate=a.getDate()),(!this.lastDate||this.lastDate<a.getDate())&&(this.lastDate=a.getDate())):s=document.createTextNode(i?"":a.getDate()),n=g("td",getClassName(a,i,this.Dict,d),i?"":"cal_"+a.getFullYear()+"_"+a.getMonth()+"_"+a.getDate()),u&&!$afe.jq(n).hasClass("hasevents")&&n.setAttribute("aria-hidden","true"),P||$$WP.Utilities.IsNullOrEmpty(s)||i?n.appendChild(s):dangerou$.setHtml(n,s),t.appendChild(n),a.setDate(a.getDate()+1)}r.appendChild(t)}return r.innerHTML},drawCalendarDate:function $$WP$Components$Calendar$drawCalendarDate(e){return'<span class="clearlabel">'+$$WP.I18N.getCalendarDateAriaString(e)+"</span>"+'<span aria-hidden="true">'+e.getDate()+"</span>"}},Handlebars.registerHelper("$$WP$Components$Calendar$getCalendarObject",(function(e){return new Handlebars.SafeString($$WP.Components.getInstance(e).getCalendarObject())})),$$WP.Components.Calendar.extend("Components.TemplateComponent");